$.fn.extend({fadeOutRemove:function(A){$(this).fadeOut(A||300,function(){$(this).remove()})}});var prefboxRequest;var resetPreferencesSidebar=function(A,C){if(typeof prefboxRequest!="undefined"){prefboxRequest.abort()}var B=findOpenProsideItem();if(C){$("body.proside-layer2").removeClass("proside-layer2")}else{$("body.proside-layer2").removeClass("proside-layer2");$("#lightboxOverlay").hide()}$("#proSidebar .heading.open").removeClass("open");$("#historyctrl-deletepop").remove();$("#proSidebar .subsectionNav.openSubNav").removeClass("openSubNav");if(!$(B).hasClass("expanded")){closeExpandedSidebar()}$("#addToFavForm").fadeOut();if($("#subpanel #subpanel-customize").length>0){$("#subpanel").fadeOut(300,function(){$(this).remove()})}closeDidYouKnow();$("#proSidebar .heading span.arrow, #proSidebar .subsectionNav span.arrow").hide();$("#preferenceBox").fadeOut(200);cleanupFileCtrlPopups()};var findOpenProsideItem=function(){return $("#proSidebar").find(".open, .openSubNav")};var closeExpandedSidebar=function(){$("#proSidebar").find(".expanded.expands").trigger("click.submenu")};var closeDidYouKnow=function(){var A=$("#favs-didyouknow");if(A.length>0){A.fadeOutRemove()}};function unexpandLeftSidebarMenu(A){$("body").removeClass("proside-layer2");$("#lsidebar .arrow").hide();if(typeof A!=="undefined"&&A){resetPreferencesSidebar("",A)}else{resetPreferencesSidebar()}}var manipPrefArrow=function(A){$("#lsidebar span.arrow").remove();$(A).append('<span class="arrow"></span>');arrowel=$("#lsidebar span.arrow");if($(A).is("li")){arrowel.addClass("list-arrow")}else{if(A.parent("#proside-favorites").length>0){arrowel.addClass("favorites-arrow")}}};var setupSpinner=function(A){var C={lines:12,length:10,width:4,radius:10,color:"#555",speed:0.9,trail:60,shadow:false};$("#lsidebar .proside-loading2-subnav, #lsidebar .proside-loading2").remove();var D=new Spinner(C).spin();var B=A.is(".subsectionNav")?"proside-loading2-subnav":"proside-loading2";$(D.el).addClass(B);return D};var preferenceBoxLoad=function(A,C){$("#addToFavForm").fadeOut();$("#historyctrl-deletepop").remove();showLsidebar();if(user.isEnabled("signedin")!==null){$(".proside-loading").remove();$("ul.subnav").hide();var D=setupSpinner(A);$("#preferenceBox").html("<div id='spinContainer' style='position: absolute; right: 300px; top: 150px; display: block;'></div>");D.el.style["float"]="none";$("#spinContainer").html(D.el);$("#preferenceBox").fadeIn(200);var B=$.get(C,{_:""+new Date().getTime()},function(F,E){$("#preferenceBox").html(F);$(D.el).removeClass();D.stop();A.removeClass("empty")}).done(function(){if(A.parent("#proside-uploads").length>0||A.is(".subsectionNav")){$("ul.subnav").show();$("#proSidebar .heading.open").addClass("open")}});if(typeof prefboxRequest!="undefined"){prefboxRequest.abort()}prefboxRequest=B}else{$("#preferenceBox").fadeIn(100);A.removeClass("empty")}if(A.is(".heading")){$("#proSidebar .heading.open").removeClass("open")}$("#proSidebar .subsectionNav.openSubNav").removeClass("openSubNav");$("body").addClass("proside-layer2");$("#verify-popup.lightbox").fadeOutRemove(300);$("#popanchor").children().fadeOutRemove();if(!A.parent("#proside-history").length>0){closeDidYouKnow()}hideCDFContent();$("body").trigger("click.removeAuthbox");$("#lightboxOverlay").show();if(A.is(".heading")){A.addClass("open")}else{A.addClass("openSubNav")}};function prefBoxPopupsCleanup(){$("#filectrl-deletepop, #filectrl-renamepop, #rawdatauploads-editpop").remove()}var recentlyOpened=false;var preferenceBox=function(A,C,B){if(typeof B!=="undefined"&&typeof A[0]!=="undefined"){if(A[0].id==="proside-downloaddata"||(A[0].id==="proside-preferences"&&!user.isEnabled("signedin"))||A[0].id==="proside-uploads-images"||A[0].id==="proside-uploads-rawdata"||A[0].id==="proside-uploads-generic"||A.closest("#proside-uploads").length>0){C=determineTrialButton(C,B)}else{if(!user.isEnabled("signedin")){C=B}}}if(A.not("li").length>0){A=A.find(".heading")}A.live("click.prefbox",function(J){J.preventDefault();J.stopPropagation();prefBoxPopupsCleanup();var E=$(A[0]).hasClass("subsectionNav")?true:false;var F=$("#proside-uploads").find(".expanded").length>0?true:false;var D=(A.is(".open")||A.is(".openSubNav"))?true:false;var H=$(A[0]).hasClass("expands")?true:false;if(H&&!F){var G=$(A[0]);G.addClass("expanded");G.siblings("ul.subnav").slideDown("fast")}else{if(H&&F){return }}if(A){if(A.parent()[0]){if(A&&A.parent()&&((A.parent()[0].id==="proside-account"&&!user.isEnabled("signedin"))||A.parent()[0].id==="proside-uploads")&&typeof B=="function"){B();return }}}if((user.isEnabled("signedin")&&A.is("a#proside-preference"))&&typeof C=="function"){console.log("gree");C();return }if(D){}else{if(!D&&F&&!E&&!recentlyOpened&&typeof C!="undefined"){var I=$("#proSidebar").find(".expanded");if(I.hasClass("expanded")){I.removeClass("expanded")}$("#proside-uploads").find("ul.subnav").slideUp("fast");preferenceBoxLoad(A,C)}else{if(typeof C!="undefined"){preferenceBoxLoad(A,C)}}}})};var resetProBar=function(){var A=$("#proSidebar");$("#proSidebar .heading span.arrow, #proSidebar .subsectionNav span.arrow").hide();A.find("ul.subnav").slideUp("fast");var C=A.find(".expanded");if(C.length>0){$(C[0]).removeClass("expanded")}var B=A.find(".openSubNav");if(B.length>0){$(B[0]).removeClass("openSubNav")}var D=A.find(".open");if(D.length>0){$(D[0]).removeClass("open")}};var determineTrialButton=function(E,C){var B="?";var D=C+"";var A=C;if(D.indexOf("?")>-1){B="&"}if(user.isEnabled("hassubscription")||((E=="/input/pro/leftsidebar/uploads/images.jsp"||E=="/input/pro/leftsidebar/uploads/rawdata.jsp"||E=="/input/pro/leftsidebar/uploads/fileuploads.jsp")&&user.isEnabled("signedin"))){A=E;if(user.isEnabled("hasCancelled")||user.isEnabled("hadpaidsubscription")){A+="?cancelled=1"}}else{if(user.isEnabled("trialeligible")&&user.isEnabled("signedin")){A=C+B+"freetrial=1";if(user.isEnabled("hasCancelled")||user.isEnabled("hadpaidsubscription")){A+="&cancelled=1"}}else{if(user.isEnabled("needsupgrade")){A=C+B+"upgrade=1";if(user.isEnabled("hasCancelled")||user.isEnabled("hadpaidsubscription")){A+="&cancelled=1"}}else{A=C;if(user.isEnabled("hasCancelled")||user.isEnabled("hadpaidsubscription")){A+=B+"cancelled=1"}}}}return A};var showFirstSubNav=function(A){return function(){var B=A.find("a.heading");if(!B.hasClass("open")&&B.siblings("ul.subnav").find("li.openSubNav").length<1){var C=A.find("li").first();setTimeout(function(){C.click()},40)}else{B.addClass("shutdown");resetPreferencesSidebar()}}};var showAccountSignin=function(){var B=function(){window.location.href=removeTrailingPound(window.location.href)};var A=function(){$.cookie("wa_pro_newuser","true",{domain:".wolframalpha.com",path:"/"});window.location.href=removeTrailingPound(window.location.href)};resetPreferencesSidebar(null,true);sendTracking("signin",$(this).attr("id"));setupSignInLB(B,A,"none")};function showLsidebar(){if($("#proSidebar").css("display")==="none"){$("#proSidebar").show()}if($("#lsidebar").css("display")==="none"){$("#lsidebar").show()}}function hideLsidebar(){if($("#proSidebar").length!=0&&$("#proSidebar").is(":visible")){$("#proSidebar, #lsidebar, #lightboxOverlay").hide()}}$(document).ready(function(){$("#lightboxOverlay").live("click",hideLsidebar);var A=[".button_signin",".account-trial",".startfreetrial",".account-create",".claimdiscount"];$("#calculatecontain, #computed,  #preferenceBox, #subpanel").delegate(A.join(", "),"click.signin",function(B){resetPreferencesSidebar(null,true);$("#subpanel, .traypopup").fadeOutRemove()});preferenceBox($("#proside-preferences"),"/input/pro/leftsidebar/preferences/general.jsp","/input/pro/leftsidebar/ads/preferences.jsp");preferenceBox($("#proside-uploads"),"/input/pro/leftsidebar/uploads/images.jsp","/input/pro/leftsidebar/ads/uploads.jsp?images=1&source=img");preferenceBox($("#proside-uploads-images"),"/input/pro/leftsidebar/uploads/images.jsp","/input/pro/leftsidebar/ads/uploads.jsp?images=1&source=img");preferenceBox($("#proside-uploads-rawdata"),"/input/pro/leftsidebar/uploads/rawdata.jsp","/input/pro/leftsidebar/ads/uploads.jsp?rawdata=1&src=data");preferenceBox($("#proside-uploads-generic"),"/input/pro/leftsidebar/uploads/fileuploads.jsp","/input/pro/leftsidebar/ads/uploads.jsp?fileuploads=1&src=upload");preferenceBox($("#proside-favorites"),"/input/pro/leftsidebar/queries/favorites.jsp","/input/pro/leftsidebar/ads/favorites.jsp");preferenceBox($("#proside-history"),"/input/pro/leftsidebar/queries/history.jsp","/input/pro/leftsidebar/ads/history.jsp");preferenceBox($("#proside-downloaddata"),"/input/pro/leftsidebar/downloads.jsp","/input/pro/leftsidebar/ads/downloaddata.jsp");preferenceBox($("#proside-account"),"/input/pro/leftsidebar/account/",showAccountSignin);preferenceBox($("#proside-uploads"),showFirstSubNav($("#proside-uploads")),showFirstSubNav($("#proside-uploads")));$("#authbox-top").live("click",function(B){$("body").trigger("click.removeAuthbox")});$("#auth-favorites").live("click",function(B){B.preventDefault();showLsidebar();$("#proside-favorites").find(".heading").trigger("click.prefbox")});$("#auth-history").live("click",function(B){B.preventDefault();showLsidebar();$("#proside-history").find(".heading").trigger("click.prefbox")});$("#auth-data").live("click",function(B){B.preventDefault();showLsidebar();$("#proside-downloaddata").find(".heading").trigger("click.prefbox")});$("#auth-uploads").live("click",function(B){B.preventDefault();showLsidebar();$("#proside-uploads").find(".heading").trigger("click")});$("#auth-preferences").live("click",function(B){B.preventDefault();showLsidebar();$("#proside-preferences > a.heading").trigger("click")});$("#auth-account").live("click",function(B){B.preventDefault();showLsidebar();$("#proside-account").find(".heading").trigger("click.prefbox")});$("#show-billing-history").live("click",function(B){B.preventDefault();if($("#billinghistory-lightbox").length>0){$("#account-lightbox").fadeOut("fast",function(){$("#billinghistory-lightbox").fadeIn()});if($("#payment-history.pod-subcontent").length>0){$("#payment-history").fadeIn()}else{$.get($(this).attr("href"),{},function(C){$("#payment-history").fadeOut("fast",function(){$("#payment-history").replaceWith($(C).find("#payment-history")).fadeIn()})})}}else{$.get($(this).attr("href"),{},function(C){$("#account-lightbox").fadeOut().after(C);$("#billinghistory-lightbox").fadeIn()})}});$("#updatePaymentMethod").live("click",function(C){var B=removeTrailingPound(window.location.href);$.cookie("wa_pro_updatebilling_redirect",encodeURIComponent(B),{domain:".wolframalpha.com",path:"/"})});$("#cancelSubscription").live("click",function(C){var B=removeTrailingPound(window.location.href);$.cookie("wa_pro_cancel_redirect",encodeURIComponent(B),{domain:".wolframalpha.com",path:"/"})});$("#back-to-account").live("click",function(B){B.preventDefault();if($("#account-lightbox").length>0){$("#billinghistory-lightbox").fadeOut("fast",function(){$("#account-lightbox").fadeIn()})}else{$.get($(this).attr("href"),{},function(C){$("#billinghistory-lightbox").fadeOut().before(C)})}});if(getURLParam("asdasd")!=""){$("#proside-downloaddata").click()}$("#proSidebar > .close").live("click",function(B){hideLsidebar();resetProBar()});$("#preferenceBox a.close").live("click",function(B){resetProBar();$("#historyctrl-deletepop").remove()});$("#histData .details .tags a").die("click").live("click",function(B){B.preventDefault();preferenceBoxLoad($("#proside-favorites .heading"),$(this).attr("href"))});$(".zero-state-open-tray").live("click",function(C){if(!$("#calculate").hasClass("index")){var B=$(this).attr("id").replace("open-tray-","");$(this).parents(".contentpod").children(".close").click();$("body").removeClass("proside-layer2");hideLsidebar();resetProBar();openInputMethodTab(B)}})});